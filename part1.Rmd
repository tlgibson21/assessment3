---
title: "part1"
author: "Lahirunee Rupasinghe & Tayla Gibson"
date: '2022-05-27'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r kable, echo=FALSE}
suppressPackageStartupMessages({
library("kableExtra")
})
```

## Section 1: Gene expression

This is my introduction to analysing gene expression.

**1. Read in the file, making the gene identifiers the row names. Show a table of values for the first six genes.**

To solve this problem, I opened [Gene expression](https://github.com/markziemann/SLE712_files/blob/master/assessment_task3/bioinfo_asst3_part1_files/gene_expression.tsv) and clicked on [View Raw](https://raw.githubusercontent.com/markziemann/SLE712_files/master/assessment_task3/bioinfo_asst3_part1_files/gene_expression.tsv). I then copied the URL and used the `read.table()` command to read in the data file. I added `header=TRUE` to remove the variable numbers at the start of each column. I then added `rownames=1` to make the gene identifiers the row names. Next, I used the assignment operator `<-` to name the function `gene_exp`. The `head()` function allowed me to display the first six genes, and the kable code styled my table.

```{r gene_exp}
# Read in data file

URL="https://raw.githubusercontent.com/markziemann/SLE712_files/master/assessment_task3/bioinfo_asst3_part1_files/gene_expression.tsv"

gene_exp <- read.table(URL, header=TRUE, row.names=1)

dt1 <- head(gene_exp)

dt1 %>%
  kbl() %>%
  kable_styling()
```

2. Make a new column which is the mean of the other columns. Show a table of values for the first six genes.

```{r mean}
# Create a new column

gene_exp$Mean <- apply(gene_exp, 1, mean)

dt2 <- head(gene_exp)

dt2 %>%
  kbl() %>%
  kable_styling()
```

3. List the 10 genes with the highest mean expression

```{r ten}
# List 10

sorted <- gene_exp[order(-gene_exp$Mean),]

list <- head(sorted, 10)

dt3 <- rownames(list)

dt3 %>%
  kbl() %>%
  kable_styling()
```

4. Determine the number of genes with a mean < 10

```{r below}
# Mean less than 10

lessthan <- subset(gene_exp,Mean < 10)

nrow(lessthan)
```

5. Make a histogram plot of the mean values and include it into your report

```{r hist}
# Plot a histogram

hist(gene_exp$Mean, xlab="Mean",
     main="Histogram of Mean Values")
```

## Section 2: Growth data

This is my introduction to analysing growth data.

```{r growth}
## GROWTH DATA FILE

### How to download file

download.file(url = "https://raw.githubusercontent.com/markziemann/SLE712_files/master/assessment_task3/bioinfo_asst3_part1_files/growth_data.csv", 
              destfile = "growth_data.csv")

### Reading file into RSTudio
d <- read.csv("growth_data.csv")
head(d)
### To check structure of data 
str(d)
### To deactivate the default setting of recognising strings as factors and remove extra headings
d <- read.csv("growth_data.csv", stringsAsFactors = FALSE, header = TRUE)
head(d)
str(d)

###Question 6

#### To find column names
colnames(d, do.NULL = TRUE, prefix = "col")

### Question 7 

#### To calculate mean


# New code to calculate mean and standard deviation

# Subset each site

site1 <- subset(d,Site == "northeast")

site2 <- subset(d,Site == "southwest")

# Mean and standard deviation at the 
# start of the study at the
# first site 'northeast'

start_site1 <- site1$Circumf_2005_cm

mean(start_site1)

sd(start_site1)

# Mean and standard deviation at the 
# end of the study at the
# first site 'northeast'

end_site1 <- site1$Circumf_2020_cm

mean(end_site1)

sd(end_site1)

# Mean and standard deviation at the 
# start of the study at the
# second site 'southwest'

start_site2 <- site2$Circumf_2005_cm

mean(start_site2)

sd(start_site2)

# Mean and standard deviation at the 
# end of the study at the
# second site 'southwest'

end_site2 <- site2$Circumf_2020_cm

mean(end_site2)

sd(end_site2)

#### To calculate standard deviation


### Question 8

#### Making a box plot


# New code for boxplot

boxplot(site1$Circumf_2005_cm,site1$Circumf_2020_cm,
        site2$Circumf_2005_cm,site2$Circumf_2020_cm,
        names=c("2005 at NE site","2020 at NE site",
                "2005 at SW site","2020 at SW site"),
        main="Tree Circumference at the Start and End of the study at Both Sites",
        ylab="Tree Circumference (cm)")
```
